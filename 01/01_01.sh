#!/bin/bash

# Проверяем передан ли логин пользователя
if [ $# -ne 1 ]; then
    echo "Использование: $0 <логин_пользователя>"
    exit 1
fi

# Сохраняем переданный логин в переменную
USER_LOGIN="$1"

# Проверяем, существует ли такой пользователь в системе
if ! id "$USER_LOGIN" &>/dev/null; then
    echo "Ошибка: Пользователь '$USER_LOGIN' не существует."
    exit 2
fi

# Получаем три последних записи входа/выхода пользователя с помощью 'last'
LAST_LOGINS=$(last -n 3 "$USER_LOGIN" 2>/dev/null)

# Проверяем, есть ли вообще записи о входах этого пользователя
if [ -z "$LAST_LOGINS" ]; then
    echo "Пользователь '$USER_LOGIN' никогда не заходил в систему."
    echo "Текущий статус: не в сети."
    exit 0
fi

# Выводим три последних входа/выхода
echo "Три последних входа/выхода пользователя '$USER_LOGIN':"
echo "$LAST_LOGINS"
echo

# Проверяем, находится ли пользователь в сети прямо сейчас
if who | grep -qw "$USER_LOGIN"; then
    echo "Комментарий: Пользователь '$USER_LOGIN' сейчас в сети."
else
    echo "Комментарий: Пользователь '$USER_LOGIN' сейчас не в сети, но ранее заходил в систему."
fi
